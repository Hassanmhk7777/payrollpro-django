<!DOCTYPE html>
<html>
<head>
    <title>Test SPA Routes PayrollPro</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-button { 
            margin: 10px; 
            padding: 10px 20px; 
            background: #007bff; 
            color: white; 
            border: none; 
            cursor: pointer; 
            border-radius: 5px;
        }
        .test-button:hover { background: #0056b3; }
        #result { 
            margin-top: 20px; 
            padding: 10px; 
            border: 1px solid #ddd; 
            min-height: 300px;
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <h1>üß™ Test des Routes SPA PayrollPro</h1>
    
    <div>
        <button class="test-button" onclick="testRoute('payroll')">Test Calcul Paie</button>
        <button class="test-button" onclick="testRoute('employees')">Test Gestion Employ√©s</button>
        <button class="test-button" onclick="testRoute('rubriques')">Test Gestion Rubriques</button>
        <button class="test-button" onclick="testRoute('absences')">Test Validation Absences</button>
        <button class="test-button" onclick="testRoute('reports')">Test Rapports</button>
        <button class="test-button" onclick="testRoute('dashboard-admin')">Test Dashboard Admin</button>
    </div>
    
    <div id="result">
        <p>Cliquez sur un bouton pour tester une route SPA...</p>
    </div>

    <script>
        const SPA_CONFIG = {
            routes: {
                'dashboard': '/api/spa/dashboard/',
                'dashboard-admin': '/api/spa/dashboard-admin/',
                'dashboard-rh': '/api/spa/dashboard-rh/',
                'employees': '/api/spa/employees/',
                'absences': '/api/spa/absences/',
                'payroll': '/api/spa/payroll/',
                'reports': '/api/spa/reports/',
                'rubriques': '/api/spa/rubriques/'
            }
        };

        function testRoute(section) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<p>üîÑ Test de la route: <strong>${section}</strong></p>`;
            
            const url = SPA_CONFIG.routes[section];
            
            fetch(url, {
                method: 'GET',
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                },
                credentials: 'same-origin'
            })
            .then(response => {
                console.log(`Response status: ${response.status}`);
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    resultDiv.innerHTML = `
                        <h3>‚úÖ Route ${section} fonctionne !</h3>
                        <p><strong>URL:</strong> ${url}</p>
                        <div style="max-height: 200px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; background: white;">
                            ${data.content.substring(0, 500)}...
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <h3>‚ùå Erreur pour ${section}</h3>
                        <p><strong>URL:</strong> ${url}</p>
                        <p><strong>Erreur:</strong> ${data.error || 'Erreur inconnue'}</p>
                    `;
                }
            })
            .catch(error => {
                resultDiv.innerHTML = `
                    <h3>‚ùå Erreur de connexion pour ${section}</h3>
                    <p><strong>URL:</strong> ${url}</p>
                    <p><strong>Erreur:</strong> ${error.message}</p>
                `;
            });
        }
    </script>
</body>
</html>
